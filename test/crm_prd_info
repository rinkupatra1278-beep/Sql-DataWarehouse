select distinct prd_line from bronze.crm_prd_info
--duplicate or null values
select prd_id,
count(*) as prd_count
from bronze.crm_prd_info
group by prd_id
having count(*) > 1 or prd_id is null

select top 5 prd_key
from bronze.crm_prd_info;

select top 5 sls_prd_key
from bronze.crm_sales_details

select top 5 id
from  bronze.erp_px_cat_g1v2

select * ,
replace(substring(prd_key,1,5),'-','_') as cat_id,
substring(prd_key,7,len(prd_key)) as prd_key
from bronze.crm_prd_info

-- we want to check if we have any products that are not included in the order ?
select sls_prd_key from bronze.crm_sales_details

select * ,
replace(substring(prd_key,1,5),'-','_') as cat_id,
substring(prd_key,7,len(prd_key)) as prd_key
from bronze.crm_prd_info
where substring(prd_key,7,len(prd_key)) not in(
select sls_prd_key from bronze.crm_sales_details );

--check for unwanted spaces
select prd_nm
from bronze.crm_prd_info
where prd_nm != trim(prd_nm)

--check for nulls or negative numbers
select prd_cost from bronze.crm_prd_info
where prd_cost < 0 or prd_cost is null

---


select * from silver.crm_prd_info
--
select prd_line,
case
    when upper(trim(prd_line)) = 'M' then 'mountain'
	 when upper(trim(prd_line)) = 'S' then 'Othersales'
     when upper(trim(prd_line)) = 'T' then 'Touring'
	 when upper(trim(prd_line)) = 'R' then 'Road'
	 else 'n/a'
	 end as prd_line from bronze.crm_prd_info

--check for values where end date is less than the start date
select * from bronze.crm_prd_info
where prd_end_dt < prd_start_dt;
